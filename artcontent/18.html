<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>2022/08/24 09:06</title><meta name="description" content="2022/08/24 09:06"/><link rel="icon" href="/CarStation.svg"/><meta name="google-site-verification" content="JPHZGs4Zk2iX0LKmv_kGBKtIfuo3rUJCO0AD6aP8bYc"/><meta name="next-head-count" content="6"/><link rel="preload" href="/_next/static/css/6e0c8d9ced1e22d0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e0c8d9ced1e22d0.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b24a9a06bb53618e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b24a9a06bb53618e.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-7180b5018c6594e2.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-a6a17768821d805e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-cc4289bbb2571876.js" defer=""></script><script src="/_next/static/chunks/647-2045c5df6fd5ed37.js" defer=""></script><script src="/_next/static/chunks/337-dc7edfac29e0cd58.js" defer=""></script><script src="/_next/static/chunks/pages/artcontent/%5Baid%5D-35eb7a1c749591f7.js" defer=""></script><script src="/_next/static/kRrtnNUirzJtMh_xDWC5r/_buildManifest.js" defer=""></script><script src="/_next/static/kRrtnNUirzJtMh_xDWC5r/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="rootPage"><div class="pageHeader" style="background-image:url(/_next/static/media/sea-bg.34630b96.jpg)"><div class="pageHeaderContent pageHeaderContent-detail">诗和远方</div></div><div class="layouts"><div class="layoutsmenu"><div class="layoutsmenufixed" style="height:0"><div class="players"><button type="button" class="ant-btn ant-btn-link layoutsButton"><span role="img" aria-label="home" class="anticon anticon-home"><svg viewBox="64 64 896 896" focusable="false" data-icon="home" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M946.5 505L560.1 118.8l-25.9-25.9a31.5 31.5 0 00-44.4 0L77.5 505a63.9 63.9 0 00-18.8 46c.4 35.2 29.7 63.3 64.9 63.3h42.5V940h691.8V614.3h43.4c17.1 0 33.2-6.7 45.3-18.8a63.6 63.6 0 0018.7-45.3c0-17-6.7-33.1-18.8-45.2zM568 868H456V664h112v204zm217.9-325.7V868H632V640c0-22.1-17.9-40-40-40H432c-22.1 0-40 17.9-40 40v228H238.1V542.3h-96l370-369.7 23.1 23.1L882 542.3h-96.1z"></path></svg></span><span>主页</span></button><button type="button" class="ant-btn ant-btn-link layoutsButton"><span role="img" aria-label="snippets" class="anticon anticon-snippets"><svg viewBox="64 64 896 896" focusable="false" data-icon="snippets" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M832 112H724V72c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v40H500V72c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v40H320c-17.7 0-32 14.3-32 32v120h-96c-17.7 0-32 14.3-32 32v632c0 17.7 14.3 32 32 32h512c17.7 0 32-14.3 32-32v-96h96c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM664 888H232V336h218v174c0 22.1 17.9 40 40 40h174v338zm0-402H514V336h.2L664 485.8v.2zm128 274h-56V456L544 264H360v-80h68v32c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-32h152v32c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-32h68v576z"></path></svg></span><span>刷新页面</span></button><button type="button" class="ant-btn ant-btn-link layoutsButton"><span role="img" aria-label="github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></span><span>我的主页</span></button></div></div><div class="adminControl"><span class="adminControl-line1"></span><span class="adminControl-line2"><span class="adminControl-line4"></span></span><span class="adminControl-line3"></span></div></div><div class="layoutsMain"><div><main class="artcontent_main__Q2ogA"><h1>2022/08/24 09:06</h1><p>Loading ...</p><div class="artcontent_extra__RKNS4"><div>2022/08/24</div></div></main></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"datas":{"id":18,"art_title":"2022/08/24 09:06","art_content":"\u003ch3 style=\"text-align: start;\"\u003eISR\u003c/h3\u003e\u003cp\u003e\u003cspan style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-size: 14px;\"\u003eNext.js 推出的 ISR(Incremental Static Regeneration) 方案，允许在\u003c/span\u003e\u003cspan style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-size: 14px;\"\u003e\u003cstrong\u003e应用运行时再重新生成每个页面 HTML，而不需要重新构建整个应用\u003c/strong\u003e\u003c/span\u003e\u003cspan style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-size: 14px;\"\u003e。这样即使有海量页面，也能使用上 SSG 的特性。一般来说，使用 ISR 需要 \u003c/span\u003egetStaticPaths\u003cspan style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-size: 14px;\"\u003e 和 \u003c/span\u003egetStaticProps\u003cspan style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-size: 14px;\"\u003e 同时配合使用。举个例子：\u003c/span\u003e\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// pages/posts/[id].js\r\nfunction Post(props) {\r\n  const { postData } = props;\r\n  \r\n  return \u0026lt;div\u0026gt;{postData.title}\u0026lt;/div\u0026gt;\r\n}\r\n\r\nexport async function getStaticPaths() {\r\n  const paths = await fetch('https://.../posts');\r\n  return {\r\n    paths,\r\n    // 页面请求的降级策略，这里是指不降级，等待页面生成后再返回，类似于 SSR\r\n    fallback: 'blocking'\r\n  }\r\n}\r\n\r\nexport async function getStaticProps({ params }) {\r\n  // 使用 params.id 获取对应的静态数据\r\n  const postData = await getPostData(params.id)\r\n  return {\r\n    props: {\r\n      postData\r\n    },\r\n    // 开启 ISR，最多每10s重新生成一次页面\r\n    revalidate: 10,\r\n  }\r\n}\u003c/code\u003e\u003c/pre\u003e\u003cp style=\"text-align: start;\"\u003e在应用编译构建阶段，会生成已经确定的静态页面，和上面 SSG 执行流程一致。\u003c/p\u003e\u003cp style=\"text-align: start;\"\u003e在 \u003cspan style=\"background-color: rgba(27, 31, 35, 0.05); font-size: 12px;\"\u003e\u003ccode\u003egetStaticProps\u003c/code\u003e\u003c/span\u003e 函数返回的对象中增加 \u003cspan style=\"background-color: rgba(27, 31, 35, 0.05); font-size: 12px;\"\u003e\u003ccode\u003erevalidate\u003c/code\u003e\u003c/span\u003e 属性，表示开启 ISR。在上面的例子中，指定 \u003cspan style=\"background-color: rgba(27, 31, 35, 0.05); font-size: 12px;\"\u003e\u003ccode\u003erevalidate = 10\u003c/code\u003e\u003c/span\u003e，表示最多10秒内重新生成一次静态 HTML。当浏览器请求已在构建时渲染生成的页面时，首先返回的是缓存的 HTML，10s 后页面开始重新渲染，页面成功生成后，更新缓存，浏览器再次请求页面时就能拿到最新渲染的页面内容了。\u003c/p\u003e\u003cp style=\"text-align: start;\"\u003e对于浏览器请求构建时未生成的页面时，会马上生成静态 HTML。在这个过程中，\u003cspan style=\"background-color: rgba(27, 31, 35, 0.05); font-size: 12px;\"\u003e\u003ccode\u003egetStaticPaths\u003c/code\u003e\u003c/span\u003e 返回的 \u003cspan style=\"background-color: rgba(27, 31, 35, 0.05); font-size: 12px;\"\u003e\u003ccode\u003efallback\u003c/code\u003e\u003c/span\u003e 字段有以下的选项：\u003c/p\u003e\u003cul style=\"text-align: start;\"\u003e\u003cli\u003e\u003cspan style=\"background-color: rgba(27, 31, 35, 0.05); font-size: 12px;\"\u003e\u003ccode\u003efallback: 'blocking'\u003c/code\u003e\u003c/span\u003e：不降级，并且要求用户请求一直等到新页面静态生成结束，静态页面生成结束后会缓存\u003c/li\u003e\u003cli\u003e\u003cspan style=\"background-color: rgba(27, 31, 35, 0.05); font-size: 12px;\"\u003e\u003ccode\u003efallback: true\u003c/code\u003e\u003c/span\u003e：降级，先返回降级页面，当静态页面生成结束后，会返回一个 JSON 供降级页面 CSR 使用，经过二次渲染后，完整页面出来了\u003c/li\u003e\u003c/ul\u003e\u003cp style=\"text-align: start;\"\u003e在上面的例子中，使用的是不降级方案(\u003cspan style=\"background-color: rgba(27, 31, 35, 0.05); font-size: 12px;\"\u003e\u003ccode\u003efallback: 'blocking'\u003c/code\u003e\u003c/span\u003e)，实际上和 SSR 方案有相似之处，都是阻塞渲染，只不过多了缓存而已。\u003c/p\u003e\u003cp style=\"text-align: start;\"\u003eIf fallback is 'blocking', new paths not returned by getStaticPaths will wait for the HTML to be generated, identical to SSR (hence why blocking), and then be cached for future requests so it only happens once per path.\u003c/p\u003e\u003cp style=\"text-align: start;\"\u003e也不是所有场景都适合使用 ISR。对于实时性要求较高的场景，比如新闻资讯类的网站，可能 SSR 才是最好的选择。\u003c/p\u003e","art_author":"yellow star","art_createtime":"2022-08-24T01:07:51.000Z","art_tags":null}},"__N_SSG":true},"page":"/artcontent/[aid]","query":{"aid":"18"},"buildId":"kRrtnNUirzJtMh_xDWC5r","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>